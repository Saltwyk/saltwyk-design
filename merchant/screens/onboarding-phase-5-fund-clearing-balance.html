<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Onboarding Phase 5: Fund Clearing Balance | Merchant Screens | Saltwyk Design System</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fraunces:ital,opsz,wght@0,9..144,100..900;1,9..144,100..900&family=Inter:wght@400;500;600;700&family=Outfit:wght@600&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="/assets/config/tailwind.config.js"></script>
    <link rel="stylesheet" href="/assets/config/design-tokens.css">
    <link rel="stylesheet" href="/assets/config/view-toggle.css">

    <style>
        .font-display { font-family: 'Fraunces', Georgia, serif; }
        .font-brand { font-family: 'Outfit', system-ui, sans-serif; }
        .serial { font-weight: 600; font-size: 11px; letter-spacing: 0.12em; text-transform: uppercase; }
        code { font-size: 11px; background: hsl(var(--warm-100)); padding: 2px 6px; border-radius: 4px; font-family: ui-monospace, monospace; }

        .thread-cool {
            background: linear-gradient(90deg, hsl(var(--cyan-thread)), hsl(var(--magenta-thread)));
        }

        /* Setup Progress */
        .progress-steps { display: flex; align-items: center; gap: 8px; }
        .step-dot { width: 10px; height: 10px; border-radius: 50%; background: hsl(var(--warm-300)); flex-shrink: 0; }
        .step-dot.completed { background: hsl(var(--emerald-500)); }
        .step-dot.active { background: hsl(var(--indigo-500)); box-shadow: 0 0 0 4px hsl(var(--indigo-100)); }
        .step-line { flex: 1; height: 2px; background: hsl(var(--warm-200)); }
        .step-line.completed { background: hsl(var(--emerald-500)); }

        .mobile-step-card { background: white; border: 1px solid hsl(var(--warm-200)); border-radius: 12px; padding: 20px; }
        .mobile-step-card .step-counter { font-size: 12px; color: hsl(var(--warm-500)); margin-bottom: 4px; }
        .mobile-step-card h3 { font-size: 18px; font-weight: 600; color: hsl(var(--ink)); margin-bottom: 4px; }
        .mobile-step-card p { font-size: 14px; color: hsl(var(--warm-500)); }

        /* Onboarding Layout */
        .onboarding-screen { max-width: 680px; margin: 0 auto; padding: 40px 24px; }
        .onboarding-header { margin-bottom: 32px; }
        .onboarding-back { display: inline-flex; align-items: center; gap: 8px; font-size: 14px; color: hsl(var(--warm-500)); text-decoration: none; margin-bottom: 16px; }
        .onboarding-back:hover { color: hsl(var(--warm-700)); }
        .onboarding-title { font-family: 'Fraunces', Georgia, serif; font-size: 28px; font-weight: 700; color: hsl(var(--ink)); margin-bottom: 8px; }
        .onboarding-subtitle { font-size: 16px; color: hsl(var(--warm-600)); line-height: 1.5; }

        /* Info Box #1: Why You Need a Clearing Balance */
        .info-box-primary { background: hsl(var(--indigo-50)); border: 2px solid hsl(var(--indigo-200)); border-radius: 8px; padding: 24px; margin-bottom: 24px; }
        .info-box-title { font-size: 18px; font-weight: 600; color: hsl(var(--ink)); margin-bottom: 12px; }
        .info-box-intro { font-size: 15px; color: hsl(var(--warm-700)); line-height: 1.6; margin-bottom: 16px; }
        .example-box { background: white; border: 1px solid hsl(var(--indigo-200)); border-radius: 6px; padding: 16px; margin: 16px 0; }
        .example-title { font-size: 14px; font-weight: 600; color: hsl(var(--warm-700)); margin-bottom: 8px; }
        .example-list { list-style: none; padding: 0; margin: 0; }
        .example-list li { font-size: 14px; color: hsl(var(--warm-700)); line-height: 1.6; padding-left: 20px; position: relative; margin-bottom: 4px; }
        .example-list li::before { content: "•"; position: absolute; left: 0; color: hsl(var(--indigo-400)); }
        .info-box-conclusion { font-size: 15px; color: hsl(var(--warm-700)); line-height: 1.6; margin-top: 16px; }

        /* Info Box #2: How It Works */
        .info-box-secondary { background: hsl(var(--emerald-50)); border: 2px solid hsl(var(--emerald-200)); border-radius: 8px; padding: 24px; margin-bottom: 32px; }
        .flow-diagram-simple { text-align: center; padding: 16px 0; }
        .flow-step { margin-bottom: 8px; }
        .flow-label { font-size: 14px; font-weight: 500; color: hsl(var(--warm-700)); margin-bottom: 4px; }
        .flow-arrow { font-size: 14px; color: hsl(var(--warm-600)); }
        .flow-step--highlight { margin: 16px 0; }
        .flow-box { display: inline-block; background: white; border: 2px solid hsl(var(--emerald-300)); border-radius: 12px; padding: 16px 24px; text-align: center; }
        .flow-box strong { font-size: 15px; color: hsl(var(--ink)); }
        .flow-badge { display: inline-block; margin-top: 8px; padding: 4px 12px; background: hsl(var(--emerald-600)); color: white; font-size: 12px; font-weight: 600; border-radius: 12px; }
        .flow-arrows-bidirectional { display: flex; justify-content: center; gap: 24px; margin-top: 12px; }
        .flow-arrow-down { font-size: 13px; color: hsl(var(--emerald-600)); }
        .flow-arrow-up { font-size: 13px; color: hsl(var(--indigo-600)); }
        .flow-note { font-size: 12px; color: hsl(var(--warm-500)); font-style: italic; margin-top: 4px; }
        .flow-tagline { font-size: 15px; color: hsl(var(--warm-700)); text-align: center; margin-top: 16px; }

        /* Clearing Balance Calculator (from component library) */
        .calculator-container { max-width: 600px; margin: 0 auto; }
        .calculator-header { margin-bottom: 24px; text-align: center; }
        .calculator-title { font-size: 18px; font-weight: 600; color: hsl(var(--warm-900)); margin-bottom: 8px; }
        .calculator-description { font-size: 14px; color: hsl(var(--warm-600)); line-height: 1.5; }

        .recommendation-box { background: hsl(var(--emerald-50)); border: 2px solid hsl(var(--emerald-200)); border-radius: 12px; padding: 32px; text-align: center; margin-bottom: 24px; }
        .recommendation-box.warning { border-color: hsl(var(--orange-300)); }
        .recommendation-label { font-size: 14px; font-weight: 600; color: hsl(var(--warm-700)); margin-bottom: 12px; }
        .amount-display { font-size: 48px; font-weight: 700; color: hsl(var(--emerald-600)); letter-spacing: -0.02em; margin-bottom: 24px; transition: color 0.15s ease; }
        .amount-display.warning { color: hsl(var(--orange-500)); }

        .slider-container { margin-bottom: 20px; padding: 0 4px; }
        .balance-slider { -webkit-appearance: none; appearance: none; width: 100%; height: 6px; background: hsl(var(--warm-200)); border-radius: 3px; outline: none; cursor: pointer; }
        .balance-slider::-webkit-slider-thumb { -webkit-appearance: none; appearance: none; width: 24px; height: 24px; background: hsl(var(--emerald-500)); border-radius: 50%; cursor: pointer; border: 2px solid white; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.15); transition: background 0.15s ease, transform 0.1s ease; }
        .balance-slider::-webkit-slider-thumb:hover { background: hsl(var(--emerald-600)); transform: scale(1.1); }
        .balance-slider::-moz-range-thumb { width: 24px; height: 24px; background: hsl(var(--emerald-500)); border-radius: 50%; cursor: pointer; border: 2px solid white; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.15); }
        .balance-slider:focus::-webkit-slider-thumb { box-shadow: 0 0 0 3px hsl(var(--emerald-500) / 30%), 0 2px 4px rgba(0, 0, 0, 0.15); }
        .slider-labels { display: flex; justify-content: space-between; margin-top: 8px; }
        .slider-label { font-size: 12px; font-weight: 500; color: hsl(var(--warm-500)); }

        .custom-input-container { display: flex; align-items: center; gap: 12px; justify-content: center; }
        .custom-input-label { font-size: 14px; font-weight: 500; color: hsl(var(--warm-700)); white-space: nowrap; }
        .custom-input-wrapper { position: relative; width: 140px; }
        .custom-input-prefix { position: absolute; left: 16px; top: 50%; transform: translateY(-50%); font-size: 16px; font-weight: 500; color: hsl(var(--warm-500)); pointer-events: none; }
        .custom-input { width: 100%; padding: 12px 16px 12px 32px; font-size: 16px; font-weight: 500; color: hsl(var(--warm-900)); background: white; border: 1px solid hsl(var(--warm-300)); border-radius: 6px; transition: border-color 0.15s ease, box-shadow 0.15s ease; }
        .custom-input:focus { outline: none; border-color: hsl(var(--emerald-500)); box-shadow: 0 0 0 3px hsl(var(--emerald-500) / 10%); }

        .coverage-box { background: white; border: 1px solid hsl(var(--warm-200)); border-radius: 8px; padding: 24px; box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05); margin-bottom: 24px; }
        .coverage-title { font-size: 16px; font-weight: 600; color: hsl(var(--warm-900)); margin-bottom: 16px; }
        .coverage-list { list-style: none; padding: 0; margin: 0; }
        .coverage-list li { font-size: 14px; color: hsl(var(--warm-700)); line-height: 1.6; padding-left: 16px; position: relative; margin-bottom: 4px; }
        .coverage-list li::before { content: "•"; position: absolute; left: 0; color: hsl(var(--warm-400)); }
        .coverage-list .highlight { color: hsl(var(--emerald-600)); font-weight: 500; }

        /* Payment Methods */
        .payment-methods { margin-top: 32px; }
        .payment-methods-title { font-size: 16px; font-weight: 600; color: hsl(var(--ink)); margin-bottom: 16px; }
        .payment-method-option { display: flex; gap: 16px; padding: 16px; background: white; border: 2px solid hsl(var(--warm-200)); border-radius: 10px; margin-bottom: 12px; cursor: pointer; transition: all 0.15s ease; }
        .payment-method-option:hover { border-color: hsl(var(--warm-300)); }
        .payment-method-option.selected { border-color: hsl(var(--indigo-500)); background: hsl(var(--indigo-50)); }
        .payment-method-option input[type="radio"] { width: 20px; height: 20px; margin: 0; accent-color: hsl(var(--indigo-500)); cursor: pointer; flex-shrink: 0; margin-top: 2px; }
        .payment-method-content { flex: 1; }
        .payment-method-header { display: flex; align-items: center; gap: 12px; margin-bottom: 4px; flex-wrap: wrap; }
        .payment-method-name { font-size: 15px; font-weight: 600; color: hsl(var(--ink)); }
        .payment-method-badge { display: inline-flex; padding: 4px 10px; background: hsl(var(--emerald-100)); color: hsl(var(--emerald-700)); font-size: 12px; font-weight: 500; border-radius: 12px; }
        .payment-method-badge--fee { background: hsl(var(--orange-100)); color: hsl(var(--orange-700)); }
        .payment-method-description { font-size: 13px; color: hsl(var(--warm-600)); }
        .btn-add-card { background: none; border: none; color: hsl(var(--indigo-600)); font-size: 13px; font-weight: 500; cursor: pointer; padding: 0; }
        .btn-add-card:hover { text-decoration: underline; }

        /* Form Actions */
        .form-actions { display: flex; justify-content: space-between; align-items: center; margin-top: 32px; padding-top: 24px; border-top: 1px solid hsl(var(--warm-200)); }

        .btn-back { display: inline-flex; align-items: center; gap: 8px; padding: 12px 20px; background: white; color: hsl(var(--warm-600)); border: 1px solid hsl(var(--warm-300)); border-radius: 8px; font-size: 14px; font-weight: 500; cursor: pointer; transition: all 0.15s ease; }
        .btn-back:hover { background: hsl(var(--warm-50)); border-color: hsl(var(--warm-400)); color: hsl(var(--warm-700)); }

        .btn-submit { display: inline-flex; align-items: center; gap: 8px; padding: 12px 24px; background: hsl(var(--emerald-600)); color: white; border: none; border-radius: 8px; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.15s ease; }
        .btn-submit:hover { background: hsl(var(--emerald-700)); }

        /* Modal */
        .modal-overlay { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0, 0, 0, 0.5); display: none; align-items: center; justify-content: center; z-index: 1000; padding: 20px; }
        .modal-overlay.active { display: flex; }
        .modal-content { background: white; border-radius: 12px; width: 100%; max-width: 440px; box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1); }
        .modal-header { display: flex; align-items: center; justify-content: space-between; padding: 20px 24px; border-bottom: 1px solid hsl(var(--warm-200)); }
        .modal-header h3 { font-size: 18px; font-weight: 600; color: hsl(var(--ink)); margin: 0; }
        .modal-close { width: 32px; height: 32px; display: flex; align-items: center; justify-content: center; border: none; background: transparent; color: hsl(var(--warm-500)); cursor: pointer; border-radius: 6px; }
        .modal-close:hover { background: hsl(var(--warm-100)); color: hsl(var(--warm-700)); }
        .modal-body { padding: 24px; }
        .modal-body p { font-size: 14px; color: hsl(var(--warm-600)); line-height: 1.6; margin-bottom: 16px; }
        .card-element-placeholder { background: hsl(var(--warm-50)); border: 1px dashed hsl(var(--warm-300)); border-radius: 8px; padding: 40px 20px; text-align: center; color: hsl(var(--warm-500)); font-size: 13px; }
        .modal-footer { display: flex; justify-content: flex-end; gap: 12px; padding: 16px 24px; border-top: 1px solid hsl(var(--warm-200)); background: hsl(var(--warm-50)); }

        /* Success Message */
        .success-banner { display: none; background: hsl(var(--emerald-50)); border: 1px solid hsl(var(--emerald-200)); border-radius: 8px; padding: 16px 20px; margin-bottom: 24px; }
        .success-banner.visible { display: flex; align-items: center; gap: 12px; }
        .success-banner-icon { color: hsl(var(--emerald-500)); flex-shrink: 0; }
        .success-banner-text { font-size: 14px; color: hsl(var(--emerald-700)); }

        /* Responsive */
        @media (max-width: 639px) {
            .onboarding-screen { padding: 24px 16px; }
            .onboarding-title { font-size: 24px; }
            .diagram-container { padding: 16px; }
            .recommendation-box { padding: 24px 16px; }
            .amount-display { font-size: 40px; }
            .custom-input-container { flex-direction: column; }
            .custom-input-wrapper { width: 100%; }
            .form-actions { flex-direction: column; gap: 12px; }
            .form-actions button { width: 100%; justify-content: center; }
            .payment-method-header { flex-direction: column; align-items: flex-start; gap: 6px; }
            .modal-footer { flex-direction: column; }
            .modal-footer button { width: 100%; }
        }
    </style>
</head>
<body class="bg-ledger text-ink">
    <div id="top-nav"></div>

    <div class="flex">
        <div id="side-nav"></div>
        <main class="flex-1">
            <div class="h-[3px] w-full thread-cool"></div>

    <div class="max-w-6xl mx-auto p-8">
        <nav class="flex items-center gap-2 text-sm text-warm-500 mb-8">
            <a href="/" class="hover:text-emerald-600">Design System</a>
            <span>&rarr;</span>
            <a href="/merchant/" class="hover:text-emerald-600">Merchant</a>
            <span>&rarr;</span>
            <a href="/merchant/screens/" class="hover:text-emerald-600">Screens</a>
            <span>&rarr;</span>
            <span class="text-ink font-medium">Onboarding Phase 5</span>
        </nav>

        <header class="mb-12">
            <p class="serial text-intaglio-500 mb-2">Screen Specification</p>
            <h1 class="font-display text-4xl mb-2">Phase 5: Fund Clearing Balance</h1>
            <p class="text-warm-600">Step 5 of 9 in merchant onboarding. Determine and fund initial clearing balance for transaction processing.</p>
        </header>

        <!-- Full Screen Preview -->
        <section class="mb-16">
            <p class="serial text-intaglio-500 mb-4">1. Full Screen Preview</p>
            <p class="text-sm text-warm-600 mb-6">Complete funding flow with transaction diagram, calculator, and payment method selection.</p>

            <div class="bg-warm-100 border-2 border-warm-200 rounded-lg p-6">
                <div class="bg-ledger rounded-lg shadow-lg overflow-hidden">
                    <div class="h-[3px] w-full thread-cool"></div>

                    <div class="onboarding-screen">
                        <!-- Back Link -->
                        <a href="/merchant/screens/onboarding-phase-4-pricing.html" class="onboarding-back">
                            <i data-lucide="arrow-left" class="w-4 h-4"></i>
                            Back
                        </a>

                        <!-- Setup Progress - Step 5 of 9 -->
                        <div class="mb-8">
                            <div class="progress-steps mb-4">
                                <div class="step-dot completed"></div>
                                <div class="step-line completed"></div>
                                <div class="step-dot completed"></div>
                                <div class="step-line completed"></div>
                                <div class="step-dot completed"></div>
                                <div class="step-line completed"></div>
                                <div class="step-dot completed"></div>
                                <div class="step-line completed"></div>
                                <div class="step-dot active"></div>
                                <div class="step-line"></div>
                                <div class="step-dot"></div>
                                <div class="step-line"></div>
                                <div class="step-dot"></div>
                                <div class="step-line"></div>
                                <div class="step-dot"></div>
                                <div class="step-line"></div>
                                <div class="step-dot"></div>
                            </div>
                            <div class="mobile-step-card">
                                <p class="step-counter">Step 5 of 9</p>
                                <h3>Fund Clearing Balance</h3>
                                <p>Set up your working capital for rewards commerce transactions.</p>
                            </div>
                        </div>

                        <!-- Page Header -->
                        <div class="onboarding-header">
                            <h1 class="onboarding-title">Fund Your Clearing Balance</h1>
                            <p class="onboarding-subtitle">Set up your working capital for rewards commerce transactions.</p>
                        </div>

                        <!-- Info Box #1: Why You Need a Clearing Balance -->
                        <div class="info-box-primary">
                            <h3 class="info-box-title">Why You Need a Clearing Balance</h3>
                            <p class="info-box-intro">
                                When shoppers use <strong>other merchants' rewards</strong> at your store, you need to pay those merchants back.
                            </p>

                            <div class="example-box">
                                <h4 class="example-title">Example:</h4>
                                <ul class="example-list">
                                    <li>Shopper uses Target points at your store</li>
                                    <li>You sell $100 item</li>
                                    <li>You pay Target $100 (from clearing balance)</li>
                                    <li>Target settles back to you later</li>
                                </ul>
                            </div>

                            <p class="info-box-conclusion">
                                Your clearing balance is your <strong>float</strong> for these transactions.
                            </p>
                        </div>

                        <!-- Info Box #2: How It Works -->
                        <div class="info-box-secondary">
                            <h3 class="info-box-title">How It Works</h3>

                            <div class="flow-diagram-simple">
                                <div class="flow-step">
                                    <div class="flow-label">Your Bank Account</div>
                                    <div class="flow-arrow">↓ Fund (ACH or debit)</div>
                                </div>

                                <div class="flow-step flow-step--highlight">
                                    <div class="flow-box">
                                        <strong>Your Stripe Account</strong><br>
                                        (Clearing Balance)<br>
                                        <span class="flow-badge">FDIC-insured</span>
                                    </div>
                                    <div class="flow-arrows-bidirectional">
                                        <span class="flow-arrow-down">↓ Pay merchants</span>
                                        <span class="flow-arrow-up">↑ Receive payments</span>
                                    </div>
                                    <div class="flow-note">(Daily settlement batch)</div>
                                </div>
                            </div>

                            <p class="flow-tagline">
                                <strong>Your funds, your account.</strong> Saltwyk just orchestrates.
                            </p>
                        </div>

                        <!-- Success Banner (hidden by default) -->
                        <div class="success-banner" id="success-banner">
                            <i data-lucide="check-circle" class="success-banner-icon w-5 h-5"></i>
                            <span class="success-banner-text" id="success-text">ACH transfer initiated. Funds will arrive in 1-2 business days.</span>
                        </div>

                        <!-- Clearing Balance Calculator (Onboarding Context) -->
                        <div class="calculator-container">
                            <div class="calculator-header">
                                <h2 class="calculator-title">Calculate Your Clearing Balance</h2>
                                <p class="calculator-description">Based on your business profile, we recommend starting with the amount below.</p>
                            </div>

                            <!-- Recommendation Box -->
                            <div class="recommendation-box" id="rec-box">
                                <p class="recommendation-label">Recommended Amount</p>
                                <div class="amount-display" id="amount-display">$6,500</div>

                                <!-- Slider -->
                                <div class="slider-container">
                                    <input type="range" id="balance-slider" class="balance-slider" min="500" max="10000" step="100" value="6500" aria-label="Clearing balance amount">
                                    <div class="slider-labels">
                                        <span class="slider-label">$500</span>
                                        <span class="slider-label">$10,000</span>
                                    </div>
                                </div>

                                <!-- Custom Input -->
                                <div class="custom-input-container">
                                    <label for="custom-amount" class="custom-input-label">Or enter custom:</label>
                                    <div class="custom-input-wrapper">
                                        <span class="custom-input-prefix">$</span>
                                        <input type="text" id="custom-amount" class="custom-input" value="6,500" inputmode="numeric">
                                    </div>
                                </div>
                            </div>

                            <!-- Coverage Box -->
                            <div class="coverage-box">
                                <p class="coverage-title">What this amount covers:</p>
                                <ul class="coverage-list">
                                    <li><span class="highlight" id="tx-count">65-130</span> transactions (at $50-$100 average)</li>
                                    <li>Approximately <span class="highlight" id="days-coverage">12-18 days</span> at expected volume</li>
                                    <li><span id="penetration">10%</span> of customers expected to use rewards</li>
                                    <li>Includes 25% buffer for variability</li>
                                </ul>
                            </div>
                        </div>

                        <!-- Payment Methods -->
                        <div class="payment-methods">
                            <h3 class="payment-methods-title">How would you like to add funds?</h3>

                            <!-- ACH Transfer -->
                            <label class="payment-method-option selected" id="ach-option">
                                <input type="radio" name="payment-method" value="ach" checked>
                                <div class="payment-method-content">
                                    <div class="payment-method-header">
                                        <span class="payment-method-name">ACH Transfer</span>
                                        <span class="payment-method-badge">Free, 1-2 business days</span>
                                    </div>
                                    <p class="payment-method-description">From: Bank of America (...4567)</p>
                                </div>
                            </label>

                            <!-- Debit Card -->
                            <label class="payment-method-option" id="debit-option">
                                <input type="radio" name="payment-method" value="debit">
                                <div class="payment-method-content">
                                    <div class="payment-method-header">
                                        <span class="payment-method-name">Debit Card</span>
                                        <span class="payment-method-badge payment-method-badge--fee" id="debit-fee-badge">1.5% fee = $97.50, Instant</span>
                                    </div>
                                    <p class="payment-method-description">
                                        <button type="button" class="btn-add-card" onclick="openCardModal()">Add Debit Card</button>
                                    </p>
                                </div>
                            </label>
                        </div>

                        <!-- Form Actions -->
                        <div class="form-actions">
                            <button type="button" class="btn-back" onclick="window.history.back()">
                                <i data-lucide="arrow-left" class="w-4 h-4"></i>
                                Back
                            </button>
                            <button type="button" class="btn-submit" id="submit-btn">
                                Add <span id="btn-amount">$6,500</span> to Balance
                                <i data-lucide="arrow-right" class="w-4 h-4"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Component Breakdown -->
        <section class="mb-16">
            <p class="serial text-intaglio-500 mb-4">2. Component Breakdown</p>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <div class="bg-white border-2 border-warm-200 rounded-lg p-6">
                    <p class="font-medium text-ink mb-2">Info Box #1: Why You Need a Clearing Balance</p>
                    <p class="text-xs text-warm-500 mb-4">Business explanation with example</p>
                    <ul class="space-y-2 text-sm text-warm-600">
                        <li>Explains WHY before technical details</li>
                        <li>Concrete Target points example</li>
                        <li>Float concept introduction</li>
                        <li>Indigo styling (educational)</li>
                    </ul>
                </div>

                <div class="bg-white border-2 border-warm-200 rounded-lg p-6">
                    <p class="font-medium text-ink mb-2">Info Box #2: How It Works</p>
                    <p class="text-xs text-warm-500 mb-4">Simplified flow diagram</p>
                    <ul class="space-y-2 text-sm text-warm-600">
                        <li>Your Bank → Your Stripe Account</li>
                        <li>FDIC-insured badge</li>
                        <li>Bidirectional arrows (pay/receive)</li>
                        <li>"Your funds, your account" tagline</li>
                    </ul>
                </div>

                <div class="bg-white border-2 border-warm-200 rounded-lg p-6">
                    <p class="font-medium text-ink mb-2">Clearing Balance Calculator</p>
                    <p class="text-xs text-warm-500 mb-4">Onboarding context (no history)</p>
                    <ul class="space-y-2 text-sm text-warm-600">
                        <li>Recommendation based on category</li>
                        <li>Interactive slider ($500-$10,000)</li>
                        <li>Custom input field</li>
                        <li>Coverage estimates update live</li>
                    </ul>
                </div>

                <div class="bg-white border-2 border-warm-200 rounded-lg p-6">
                    <p class="font-medium text-ink mb-2">Payment Methods</p>
                    <p class="text-xs text-warm-500 mb-4">ACH vs Debit selection</p>
                    <ul class="space-y-2 text-sm text-warm-600">
                        <li>ACH: Free, 1-2 business days</li>
                        <li>Debit: 1.5% fee, instant</li>
                        <li>Fee updates with amount</li>
                        <li>Bank from Phase 3 shown</li>
                    </ul>
                </div>

                <div class="bg-white border-2 border-warm-200 rounded-lg p-6">
                    <p class="font-medium text-ink mb-2">Add Debit Card Modal</p>
                    <p class="text-xs text-warm-500 mb-4">Stripe Elements placeholder</p>
                    <ul class="space-y-2 text-sm text-warm-600">
                        <li>Shows total with fee</li>
                        <li>Card element placeholder</li>
                        <li>Security notice (Stripe)</li>
                        <li>Production: real Stripe Elements</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Related -->
        <section class="mb-16">
            <p class="serial text-intaglio-500 mb-4">3. Related</p>

            <div class="grid grid-cols-3 gap-4">
                <a href="/merchant/screens/onboarding-phase-4-pricing.html" class="block bg-white border-2 border-warm-200 rounded-lg p-4 hover:border-warm-300 transition-colors">
                    <p class="font-medium text-ink mb-1">Phase 4: Pricing</p>
                    <p class="text-xs text-warm-500">Previous onboarding step.</p>
                </a>
                <a href="/merchant/components/clearing-balance-calculator.html" class="block bg-white border-2 border-warm-200 rounded-lg p-4 hover:border-warm-300 transition-colors">
                    <p class="font-medium text-ink mb-1">Clearing Balance Calculator</p>
                    <p class="text-xs text-warm-500">Component documentation.</p>
                </a>
                <a href="/merchant/components/money-flow-diagram.html" class="block bg-white border-2 border-warm-200 rounded-lg p-4 hover:border-warm-300 transition-colors">
                    <p class="font-medium text-ink mb-1">Money Flow Diagram</p>
                    <p class="text-xs text-warm-500">Component documentation.</p>
                </a>
            </div>
        </section>

    </div>

    <!-- Footer -->
    <footer class="bg-white border-t-2 border-warm-200 px-8 py-8 mt-12">
        <div class="max-w-6xl mx-auto flex items-center justify-between">
            <div class="flex items-center gap-3">
                <img src="/assets/logos/svg/saltwyk-logomark-emerald.svg" alt="Saltwyk" class="h-6 w-auto opacity-50">
                <span class="text-sm text-warm-500">Saltwyk Design System v0.5</span>
            </div>
            <div class="flex items-center gap-6 text-sm text-warm-500">
                <a href="/sitemap.html" class="hover:text-emerald-600">Sitemap</a>
                <a href="/core/tokens/" class="hover:text-emerald-600">Foundation</a>
            </div>
        </div>
    </footer>
        </main>
    </div>

    <!-- Add Debit Card Modal -->
    <div class="modal-overlay" id="card-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add Debit Card</h3>
                <button class="modal-close" onclick="closeCardModal()" aria-label="Close">
                    <i data-lucide="x"></i>
                </button>
            </div>
            <div class="modal-body">
                <p>Your card will be charged <strong id="modal-total">$6,597.50</strong> (<span id="modal-amount">$6,500</span> + 1.5% fee)</p>
                <div class="card-element-placeholder">
                    [Stripe Card Element]<br>
                    Card number, expiry, CVC
                </div>
                <p style="font-size: 12px; color: hsl(var(--warm-500)); margin-top: 12px; margin-bottom: 0;">
                    <i data-lucide="lock" style="width: 12px; height: 12px; display: inline; vertical-align: middle;"></i>
                    Your payment information is secured by Stripe.
                </p>
            </div>
            <div class="modal-footer">
                <button class="btn-back" onclick="closeCardModal()">Cancel</button>
                <button class="btn-submit" id="modal-submit-btn">Add Card & Charge <span id="modal-btn-total">$6,597.50</span></button>
            </div>
        </div>
    </div>

    <script>lucide.createIcons();</script>
    <script src="/partials/nav-loader.js"></script>

    <script>
        (function() {
            // Elements
            const slider = document.getElementById('balance-slider');
            const customInput = document.getElementById('custom-amount');
            const amountDisplay = document.getElementById('amount-display');
            const btnAmount = document.getElementById('btn-amount');
            const debitFeeBadge = document.getElementById('debit-fee-badge');
            const txCount = document.getElementById('tx-count');
            const daysCoverage = document.getElementById('days-coverage');
            const submitBtn = document.getElementById('submit-btn');
            const successBanner = document.getElementById('success-banner');
            const successText = document.getElementById('success-text');

            // Modal elements
            const modalAmount = document.getElementById('modal-amount');
            const modalTotal = document.getElementById('modal-total');
            const modalBtnTotal = document.getElementById('modal-btn-total');

            // Payment method options
            const achOption = document.getElementById('ach-option');
            const debitOption = document.getElementById('debit-option');
            const paymentRadios = document.querySelectorAll('input[name="payment-method"]');

            let currentAmount = 6500;

            function formatCurrency(num) {
                return num.toLocaleString('en-US');
            }

            function updateDisplay(amount) {
                currentAmount = amount;

                // Update amount display
                amountDisplay.textContent = '$' + formatCurrency(amount);
                btnAmount.textContent = '$' + formatCurrency(amount);

                // Update slider and input
                slider.value = amount;
                customInput.value = formatCurrency(amount);

                // Update debit fee (1.5%)
                const fee = amount * 0.015;
                debitFeeBadge.textContent = '1.5% fee = $' + fee.toFixed(2) + ', Instant';

                // Update modal totals
                const total = amount + fee;
                modalAmount.textContent = '$' + formatCurrency(amount);
                modalTotal.textContent = '$' + formatCurrency(total);
                modalBtnTotal.textContent = '$' + formatCurrency(total);

                // Update coverage estimates
                const minTx = Math.floor(amount / 100);
                const maxTx = Math.floor(amount / 50);
                txCount.textContent = minTx + '-' + maxTx;

                const minDays = Math.floor(amount / 500);
                const maxDays = Math.floor(amount / 350);
                daysCoverage.textContent = minDays + '-' + maxDays + ' days';
            }

            // Slider input
            slider.addEventListener('input', function() {
                updateDisplay(parseInt(this.value));
            });

            // Custom input
            customInput.addEventListener('input', function() {
                let value = this.value.replace(/[^\d]/g, '');
                if (value) {
                    value = parseInt(value);
                    if (value < 500) value = 500;
                    if (value > 50000) value = 50000;
                    updateDisplay(value);
                }
            });

            customInput.addEventListener('blur', function() {
                this.value = formatCurrency(currentAmount);
            });

            // Payment method selection
            paymentRadios.forEach(radio => {
                radio.addEventListener('change', function() {
                    achOption.classList.toggle('selected', this.value === 'ach');
                    debitOption.classList.toggle('selected', this.value === 'debit');
                });
            });

            // Submit
            submitBtn.addEventListener('click', function() {
                const method = document.querySelector('input[name="payment-method"]:checked').value;

                this.disabled = true;
                this.innerHTML = '<span>Processing...</span>';

                setTimeout(() => {
                    if (method === 'ach') {
                        successText.textContent = 'ACH transfer initiated. Funds will arrive in 1-2 business days.';
                    } else {
                        successText.textContent = 'Funds added instantly. Available now.';
                    }
                    successBanner.classList.add('visible');
                    this.innerHTML = '<i data-lucide="check" class="w-4 h-4"></i> Funded';
                    lucide.createIcons();

                    console.log('Clearing balance funded:', {
                        amount: currentAmount,
                        payment_method: method,
                        fee: method === 'debit' ? currentAmount * 0.015 : 0
                    });
                }, 1500);
            });

            // Initial update
            updateDisplay(6500);
        })();

        // Modal functions
        function openCardModal() {
            document.getElementById('card-modal').classList.add('active');
        }

        function closeCardModal() {
            document.getElementById('card-modal').classList.remove('active');
        }

        document.getElementById('card-modal').addEventListener('click', function(e) {
            if (e.target === this) closeCardModal();
        });

        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') closeCardModal();
        });
    </script>
</body>
</html>
