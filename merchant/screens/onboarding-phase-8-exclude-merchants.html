<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Onboarding Phase 8: Exclude Merchants | Merchant Screens | Saltwyk Design System</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fraunces:ital,opsz,wght@0,9..144,100..900;1,9..144,100..900&family=Inter:wght@400;500;600;700&family=Outfit:wght@600&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="/assets/config/tailwind.config.js"></script>
    <link rel="stylesheet" href="/assets/config/design-tokens.css">
    <link rel="stylesheet" href="/assets/config/view-toggle.css">

    <style>
        .font-display { font-family: 'Fraunces', Georgia, serif; }
        .font-brand { font-family: 'Outfit', system-ui, sans-serif; }
        .serial { font-weight: 600; font-size: 11px; letter-spacing: 0.12em; text-transform: uppercase; }
        code { font-size: 11px; background: hsl(var(--warm-100)); padding: 2px 6px; border-radius: 4px; font-family: ui-monospace, monospace; }

        .thread-cool {
            background: linear-gradient(90deg, hsl(var(--cyan-thread)), hsl(var(--magenta-thread)));
        }

        /* Setup Progress */
        .progress-steps { display: flex; align-items: center; gap: 8px; }
        .step-dot { width: 10px; height: 10px; border-radius: 50%; background: hsl(var(--warm-300)); flex-shrink: 0; }
        .step-dot.completed { background: hsl(var(--emerald-500)); }
        .step-dot.active { background: hsl(var(--indigo-500)); box-shadow: 0 0 0 4px hsl(var(--indigo-100)); }
        .step-line { flex: 1; height: 2px; background: hsl(var(--warm-200)); }
        .step-line.completed { background: hsl(var(--emerald-500)); }

        .mobile-step-card { background: white; border: 1px solid hsl(var(--warm-200)); border-radius: 12px; padding: 20px; }
        .mobile-step-card .step-counter { font-size: 12px; color: hsl(var(--warm-500)); margin-bottom: 4px; }
        .mobile-step-card h3 { font-size: 18px; font-weight: 600; color: hsl(var(--ink)); margin-bottom: 4px; }
        .mobile-step-card p { font-size: 14px; color: hsl(var(--warm-500)); }

        /* Onboarding Layout */
        .onboarding-screen { max-width: 680px; margin: 0 auto; padding: 40px 24px; }
        .onboarding-header { margin-bottom: 32px; }
        .onboarding-back { display: inline-flex; align-items: center; gap: 8px; font-size: 14px; color: hsl(var(--warm-500)); text-decoration: none; margin-bottom: 16px; }
        .onboarding-back:hover { color: hsl(var(--warm-700)); }
        .onboarding-title { font-family: 'Fraunces', Georgia, serif; font-size: 28px; font-weight: 700; color: hsl(var(--ink)); margin-bottom: 8px; }
        .onboarding-title .optional { font-weight: 400; color: hsl(var(--warm-500)); }
        .onboarding-subtitle { font-size: 16px; color: hsl(var(--warm-600)); line-height: 1.5; }

        /* Info Box */
        .info-box { display: flex; gap: 16px; background: hsl(var(--warm-100)); border: 1px solid hsl(var(--warm-300)); border-radius: 8px; padding: 20px; margin-bottom: 32px; }
        .info-box-icon { color: hsl(var(--warm-600)); flex-shrink: 0; }
        .info-box-content { flex: 1; }
        .info-box-title { font-size: 16px; font-weight: 600; color: hsl(var(--ink)); margin-bottom: 8px; }
        .info-box-text { font-size: 14px; color: hsl(var(--warm-700)); line-height: 1.6; }
        .info-box-list { list-style: none; padding: 0; margin: 8px 0; }
        .info-box-list li { font-size: 14px; color: hsl(var(--warm-700)); padding-left: 20px; position: relative; margin-bottom: 4px; }
        .info-box-list li::before { content: "•"; position: absolute; left: 0; color: hsl(var(--warm-500)); }
        .info-box-footer { margin-top: 12px; font-size: 14px; color: hsl(var(--warm-600)); }

        /* Empty State */
        .empty-state { text-align: center; padding: 48px 24px; background: hsl(var(--warm-50)); border: 2px dashed hsl(var(--warm-300)); border-radius: 12px; margin-bottom: 32px; }
        .empty-state-icon { color: hsl(var(--emerald-400)); margin-bottom: 16px; display: flex; justify-content: center; }
        .empty-state-icon svg { width: 48px; height: 48px; }
        .empty-state-title { font-size: 18px; font-weight: 600; color: hsl(var(--ink)); margin-bottom: 8px; }
        .empty-state-text { font-size: 15px; color: hsl(var(--warm-600)); margin-bottom: 24px; max-width: 360px; margin-left: auto; margin-right: auto; line-height: 1.5; }
        .empty-state-actions { display: flex; flex-direction: column; gap: 16px; align-items: center; }
        .empty-state-alt { display: flex; align-items: center; gap: 8px; }
        .empty-state-or { font-size: 13px; color: hsl(var(--warm-500)); }

        /* Exclusions List */
        .exclusions-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; }
        .exclusions-title { font-size: 16px; font-weight: 600; color: hsl(var(--ink)); }
        .exclusions-count { font-size: 14px; color: hsl(var(--warm-600)); }
        .exclusions-count--limit { color: hsl(var(--orange-600)); font-weight: 500; }
        .exclusions-warning { font-size: 14px; color: hsl(var(--orange-600)); margin-top: 8px; }

        /* Exclusion Card */
        .exclusion-card { background: white; border: 1px solid hsl(var(--warm-200)); border-radius: 8px; padding: 20px; margin-bottom: 12px; }
        .exclusion-card-header { display: flex; align-items: center; gap: 16px; }
        .exclusion-card-logo { width: 48px; height: 48px; background: hsl(var(--warm-100)); border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 18px; font-weight: 600; color: hsl(var(--warm-600)); flex-shrink: 0; overflow: hidden; }
        .exclusion-card-logo img { width: 100%; height: 100%; object-fit: cover; }
        .exclusion-card-info { flex: 1; min-width: 0; }
        .exclusion-card-name { font-size: 15px; font-weight: 600; color: hsl(var(--ink)); margin-bottom: 2px; }
        .exclusion-card-domain { font-size: 13px; color: hsl(var(--warm-500)); }
        .exclusion-card-reason { margin-top: 12px; padding-top: 12px; border-top: 1px solid hsl(var(--warm-200)); }
        .exclusion-card-reason p { font-size: 14px; color: hsl(var(--warm-600)); font-style: italic; }
        .exclusion-card-actions { display: flex; justify-content: flex-end; margin-top: 12px; }

        /* Buttons */
        .btn-primary { display: inline-flex; align-items: center; gap: 8px; padding: 12px 24px; background: hsl(var(--emerald-600)); color: white; border: none; border-radius: 8px; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.15s ease; }
        .btn-primary:hover { background: hsl(var(--emerald-700)); }
        .btn-primary:disabled { opacity: 0.6; cursor: not-allowed; }

        .btn-secondary { display: inline-flex; align-items: center; gap: 8px; padding: 12px 20px; background: white; color: hsl(var(--warm-700)); border: 1px solid hsl(var(--warm-300)); border-radius: 8px; font-size: 14px; font-weight: 500; cursor: pointer; transition: all 0.15s ease; }
        .btn-secondary:hover { background: hsl(var(--warm-50)); border-color: hsl(var(--warm-400)); }
        .btn-secondary:disabled { opacity: 0.5; cursor: not-allowed; }

        .btn-text { display: inline-flex; align-items: center; gap: 6px; background: none; border: none; color: hsl(var(--indigo-600)); font-size: 14px; font-weight: 500; cursor: pointer; padding: 8px 12px; }
        .btn-text:hover { text-decoration: underline; }

        .btn-danger { color: hsl(var(--magenta-600)); }
        .btn-danger:hover { color: hsl(var(--magenta-700)); text-decoration: underline; }

        .btn-add-another { margin-top: 16px; }

        /* Form Actions */
        .form-actions { display: flex; justify-content: space-between; align-items: center; margin-top: 32px; padding-top: 24px; border-top: 1px solid hsl(var(--warm-200)); }

        .btn-back { display: inline-flex; align-items: center; gap: 8px; padding: 12px 20px; background: white; color: hsl(var(--warm-600)); border: 1px solid hsl(var(--warm-300)); border-radius: 8px; font-size: 14px; font-weight: 500; cursor: pointer; transition: all 0.15s ease; }
        .btn-back:hover { background: hsl(var(--warm-50)); border-color: hsl(var(--warm-400)); color: hsl(var(--warm-700)); }

        .btn-continue { display: inline-flex; align-items: center; gap: 8px; padding: 12px 24px; background: hsl(var(--emerald-600)); color: white; border: none; border-radius: 8px; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.15s ease; }
        .btn-continue:hover { background: hsl(var(--emerald-700)); }
        .btn-continue:disabled { opacity: 0.6; cursor: not-allowed; }

        /* Modal */
        .modal-overlay { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0, 0, 0, 0.5); display: none; align-items: center; justify-content: center; z-index: 1000; padding: 20px; }
        .modal-overlay.active { display: flex; }
        .modal-content { background: white; border-radius: 12px; width: 100%; max-width: 500px; max-height: 90vh; overflow: hidden; display: flex; flex-direction: column; box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1); }
        .modal-header { display: flex; align-items: center; justify-content: space-between; padding: 20px 24px; border-bottom: 1px solid hsl(var(--warm-200)); }
        .modal-header h3 { font-size: 18px; font-weight: 600; color: hsl(var(--ink)); margin: 0; }
        .modal-close { width: 32px; height: 32px; display: flex; align-items: center; justify-content: center; border: none; background: transparent; color: hsl(var(--warm-500)); cursor: pointer; border-radius: 6px; }
        .modal-close:hover { background: hsl(var(--warm-100)); color: hsl(var(--warm-700)); }
        .modal-body { padding: 24px; overflow-y: auto; flex: 1; }
        .modal-footer { display: flex; justify-content: flex-end; gap: 12px; padding: 16px 24px; border-top: 1px solid hsl(var(--warm-200)); background: hsl(var(--warm-50)); }

        /* Search Input */
        .search-input { position: relative; }
        .search-input svg, .search-input i { position: absolute; left: 14px; top: 50%; transform: translateY(-50%); color: hsl(var(--warm-400)); pointer-events: none; width: 20px; height: 20px; }
        .search-input input { width: 100%; padding: 12px 16px 12px 44px; font-size: 14px; color: hsl(var(--warm-900)); background: white; border: 1px solid hsl(var(--warm-300)); border-radius: 8px; transition: border-color 0.15s ease, box-shadow 0.15s ease; }
        .search-input input:focus { outline: none; border-color: hsl(var(--indigo-500)); box-shadow: 0 0 0 3px hsl(var(--indigo-500) / 10%); }
        .search-input input::placeholder { color: hsl(var(--warm-400)); }

        /* Search Results */
        .search-results { margin-top: 16px; }
        .search-results-empty { text-align: center; padding: 24px 16px; color: hsl(var(--warm-500)); font-size: 14px; }
        .merchant-result-item { display: flex; align-items: center; gap: 12px; width: 100%; padding: 12px; background: white; border: 1px solid hsl(var(--warm-200)); border-radius: 8px; cursor: pointer; transition: all 0.15s ease; margin-bottom: 8px; text-align: left; }
        .merchant-result-item:hover { border-color: hsl(var(--indigo-300)); background: hsl(var(--indigo-50)); }
        .merchant-result-item.selected { border-color: hsl(var(--indigo-500)); background: hsl(var(--indigo-50)); }
        .merchant-result-logo { width: 40px; height: 40px; background: hsl(var(--warm-100)); border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 14px; font-weight: 600; color: hsl(var(--warm-600)); flex-shrink: 0; }
        .merchant-result-info { flex: 1; min-width: 0; }
        .merchant-result-info h4 { font-size: 14px; font-weight: 600; color: hsl(var(--ink)); margin-bottom: 2px; }
        .merchant-result-info p { font-size: 12px; color: hsl(var(--warm-500)); }
        .merchant-result-item i { color: hsl(var(--indigo-500)); flex-shrink: 0; }

        /* Reason Form */
        .reason-form { margin-top: 20px; padding-top: 20px; border-top: 1px solid hsl(var(--warm-200)); }
        .reason-form label { display: block; font-size: 14px; font-weight: 500; color: hsl(var(--warm-700)); margin-bottom: 8px; }
        .reason-form textarea { width: 100%; padding: 12px; font-size: 14px; color: hsl(var(--warm-900)); background: white; border: 1px solid hsl(var(--warm-300)); border-radius: 8px; resize: vertical; min-height: 80px; transition: border-color 0.15s ease, box-shadow 0.15s ease; }
        .reason-form textarea:focus { outline: none; border-color: hsl(var(--indigo-500)); box-shadow: 0 0 0 3px hsl(var(--indigo-500) / 10%); }
        .reason-form textarea::placeholder { color: hsl(var(--warm-400)); }
        .form-hint { font-size: 12px; color: hsl(var(--warm-500)); margin-top: 6px; }

        /* Selected Merchant Preview */
        .selected-merchant { display: flex; align-items: center; gap: 12px; padding: 12px; background: hsl(var(--emerald-50)); border: 1px solid hsl(var(--emerald-200)); border-radius: 8px; margin-bottom: 16px; }
        .selected-merchant-logo { width: 40px; height: 40px; background: hsl(var(--warm-100)); border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 14px; font-weight: 600; color: hsl(var(--warm-600)); flex-shrink: 0; }
        .selected-merchant-info { flex: 1; }
        .selected-merchant-info h4 { font-size: 14px; font-weight: 600; color: hsl(var(--ink)); margin-bottom: 2px; }
        .selected-merchant-info p { font-size: 12px; color: hsl(var(--warm-500)); }
        .selected-merchant i { color: hsl(var(--emerald-500)); }

        /* Success Banner */
        .success-banner { display: none; background: hsl(var(--emerald-50)); border: 1px solid hsl(var(--emerald-200)); border-radius: 8px; padding: 16px 20px; margin-bottom: 24px; }
        .success-banner.visible { display: flex; align-items: center; gap: 12px; }
        .success-banner-icon { color: hsl(var(--emerald-500)); flex-shrink: 0; }
        .success-banner-text { font-size: 14px; color: hsl(var(--emerald-700)); }

        /* Responsive */
        @media (max-width: 639px) {
            .onboarding-screen { padding: 24px 16px; }
            .onboarding-title { font-size: 24px; }
            .info-box { flex-direction: column; gap: 12px; }
            .empty-state { padding: 32px 16px; }
            .exclusion-card { padding: 16px; }
            .exclusion-card-header { flex-wrap: wrap; }
            .form-actions { flex-direction: column; gap: 12px; }
            .form-actions button { width: 100%; justify-content: center; }
            .modal-content { max-width: 100%; max-height: 100%; border-radius: 0; }
            .modal-footer { flex-direction: column; }
            .modal-footer button { width: 100%; }
        }
    </style>
</head>
<body class="bg-ledger text-ink">
    <div id="top-nav"></div>

    <div class="flex">
        <div id="side-nav"></div>
        <main class="flex-1">
            <div class="h-[3px] w-full thread-cool"></div>

    <div class="max-w-6xl mx-auto p-8">
        <nav class="flex items-center gap-2 text-sm text-warm-500 mb-8">
            <a href="/" class="hover:text-emerald-600">Design System</a>
            <span>&rarr;</span>
            <a href="/merchant/" class="hover:text-emerald-600">Merchant</a>
            <span>&rarr;</span>
            <a href="/merchant/screens/" class="hover:text-emerald-600">Screens</a>
            <span>&rarr;</span>
            <span class="text-ink font-medium">Onboarding Phase 8</span>
        </nav>

        <header class="mb-12">
            <p class="serial text-intaglio-500 mb-2">Screen Specification</p>
            <h1 class="font-display text-4xl mb-2">Phase 8: Exclude Merchants</h1>
            <p class="text-warm-600">Step 8 of 9 in merchant onboarding. Optional step to exclude specific merchants from the network.</p>
        </header>

        <!-- Full Screen Preview -->
        <section class="mb-16">
            <p class="serial text-intaglio-500 mb-4">1. Full Screen Preview</p>
            <p class="text-sm text-warm-600 mb-6">Optional merchant exclusion with search, add, and remove functionality.</p>

            <div class="bg-warm-100 border-2 border-warm-200 rounded-lg p-6">
                <div class="bg-ledger rounded-lg shadow-lg overflow-hidden">
                    <div class="h-[3px] w-full thread-cool"></div>

                    <div class="onboarding-screen">
                        <!-- Back Link -->
                        <a href="/merchant/screens/onboarding-phase-7-payout-schedule.html" class="onboarding-back">
                            <i data-lucide="arrow-left" class="w-4 h-4"></i>
                            Back
                        </a>

                        <!-- Setup Progress - Step 8 of 9 -->
                        <div class="mb-8">
                            <div class="progress-steps mb-4">
                                <div class="step-dot completed"></div>
                                <div class="step-line completed"></div>
                                <div class="step-dot completed"></div>
                                <div class="step-line completed"></div>
                                <div class="step-dot completed"></div>
                                <div class="step-line completed"></div>
                                <div class="step-dot completed"></div>
                                <div class="step-line completed"></div>
                                <div class="step-dot completed"></div>
                                <div class="step-line completed"></div>
                                <div class="step-dot completed"></div>
                                <div class="step-line completed"></div>
                                <div class="step-dot completed"></div>
                                <div class="step-line completed"></div>
                                <div class="step-dot active"></div>
                                <div class="step-line"></div>
                                <div class="step-dot"></div>
                            </div>
                            <div class="mobile-step-card">
                                <p class="step-counter">Step 8 of 9</p>
                                <h3>Exclude Merchants</h3>
                                <p>Optionally block specific merchants from transactions.</p>
                            </div>
                        </div>

                        <!-- Page Header -->
                        <div class="onboarding-header">
                            <h1 class="onboarding-title">Exclude Merchants <span class="optional">(Optional)</span></h1>
                            <p class="onboarding-subtitle">Choose merchants you don't want to transact with on the network.</p>
                        </div>

                        <!-- Success Banner (hidden by default) -->
                        <div class="success-banner" id="success-banner">
                            <i data-lucide="check-circle" class="success-banner-icon w-5 h-5"></i>
                            <span class="success-banner-text" id="success-text">Exclusions saved successfully.</span>
                        </div>

                        <!-- Info Box: Why This Exists -->
                        <div class="info-box">
                            <div class="info-box-icon">
                                <i data-lucide="info" class="w-6 h-6"></i>
                            </div>
                            <div class="info-box-content">
                                <h3 class="info-box-title">Why would I exclude a merchant?</h3>
                                <p class="info-box-text">Some merchants prefer not to transact with specific businesses:</p>
                                <ul class="info-box-list">
                                    <li><strong>Direct competitors</strong> in the same market or category</li>
                                    <li><strong>Past disputes</strong> or unresolved business issues</li>
                                    <li><strong>Brand alignment</strong> concerns</li>
                                </ul>
                                <p class="info-box-text" style="margin-top: 12px;">
                                    Exclusions are <strong>bidirectional</strong> — neither party can use the other's rewards.
                                </p>
                                <p class="info-box-footer">
                                    Most merchants don't exclude anyone. <strong>Maximum: 10</strong>
                                </p>
                            </div>
                        </div>

                        <!-- Empty State (shown when no exclusions) -->
                        <div class="empty-state" id="empty-state">
                            <div class="empty-state-icon">
                                <i data-lucide="shield-check" class="w-12 h-12"></i>
                            </div>
                            <p class="empty-state-title">No exclusions needed?</p>
                            <p class="empty-state-text">Most merchants skip this step and transact with everyone on the network.</p>
                            <div class="empty-state-actions">
                                <button class="btn-primary" id="skip-btn">
                                    Continue Without Exclusions
                                    <i data-lucide="arrow-right" class="w-4 h-4"></i>
                                </button>
                                <div class="empty-state-alt">
                                    <span class="empty-state-or">or</span>
                                    <button class="btn-text" id="add-first-btn">
                                        <i data-lucide="plus" class="w-4 h-4"></i>
                                        Add an exclusion
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Exclusions List (shown when exclusions exist) -->
                        <div class="exclusions-list" id="exclusions-list" style="display: none;">
                            <div class="exclusions-header">
                                <h3 class="exclusions-title">Your Exclusions</h3>
                                <span class="exclusions-count" id="exclusions-count">0 of 10 used</span>
                            </div>

                            <!-- Exclusion cards container -->
                            <div id="exclusion-cards"></div>

                            <!-- Add Another Button -->
                            <button class="btn-secondary btn-add-another" id="add-another-btn">
                                <i data-lucide="plus" class="w-4 h-4"></i>
                                <span id="add-another-text">Add Another Exclusion (10 remaining)</span>
                            </button>
                        </div>

                        <!-- Form Actions -->
                        <div class="form-actions">
                            <button type="button" class="btn-back" onclick="window.history.back()">
                                <i data-lucide="arrow-left" class="w-4 h-4"></i>
                                Back
                            </button>
                            <button type="button" class="btn-continue" id="continue-btn">
                                Continue
                                <i data-lucide="arrow-right" class="w-4 h-4"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- State: With Exclusions -->
        <section class="mb-16">
            <p class="serial text-intaglio-500 mb-4">1b. With Exclusions State</p>
            <p class="text-sm text-warm-600 mb-6">When merchant has added exclusions, showing cards with remove functionality.</p>

            <div class="bg-warm-100 border-2 border-warm-200 rounded-lg p-6">
                <div class="bg-ledger rounded-lg shadow-lg overflow-hidden">
                    <div class="h-[3px] w-full thread-cool"></div>

                    <div class="onboarding-screen">
                        <!-- Exclusions Header -->
                        <div class="exclusions-header">
                            <h3 class="exclusions-title">Your Exclusions</h3>
                            <span class="exclusions-count">2 of 10 used</span>
                        </div>

                        <!-- Exclusion Card 1 - With Reason -->
                        <div class="exclusion-card">
                            <div class="exclusion-card-header">
                                <div class="exclusion-card-logo">CS</div>
                                <div class="exclusion-card-info">
                                    <h4 class="exclusion-card-name">Competitor Store</h4>
                                    <p class="exclusion-card-domain">competitor-store.com</p>
                                </div>
                            </div>
                            <div class="exclusion-card-reason">
                                <p>"Direct competitor in same market"</p>
                            </div>
                            <div class="exclusion-card-actions">
                                <button class="btn-text btn-danger">Remove</button>
                            </div>
                        </div>

                        <!-- Exclusion Card 2 - Without Reason -->
                        <div class="exclusion-card">
                            <div class="exclusion-card-header">
                                <div class="exclusion-card-logo">PM</div>
                                <div class="exclusion-card-info">
                                    <h4 class="exclusion-card-name">Problem Merchant</h4>
                                    <p class="exclusion-card-domain">problem-merchant.com</p>
                                </div>
                            </div>
                            <div class="exclusion-card-actions">
                                <button class="btn-text btn-danger">Remove</button>
                            </div>
                        </div>

                        <!-- Add Another Button -->
                        <button class="btn-secondary btn-add-another">
                            <i data-lucide="plus" class="w-4 h-4"></i>
                            Add Another Exclusion (8 remaining)
                        </button>

                        <!-- Form Actions -->
                        <div class="form-actions">
                            <button type="button" class="btn-back">
                                <i data-lucide="arrow-left" class="w-4 h-4"></i>
                                Back
                            </button>
                            <button type="button" class="btn-continue">
                                Continue
                                <i data-lucide="arrow-right" class="w-4 h-4"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Component Breakdown -->
        <section class="mb-16">
            <p class="serial text-intaglio-500 mb-4">2. Component Breakdown</p>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <div class="bg-white border-2 border-warm-200 rounded-lg p-6">
                    <p class="font-medium text-ink mb-2">Info Box: Why Exclude?</p>
                    <p class="text-xs text-warm-500 mb-4">Explains use cases</p>
                    <ul class="space-y-2 text-sm text-warm-600">
                        <li>Direct competitors</li>
                        <li>Past disputes</li>
                        <li>Brand alignment concerns</li>
                        <li>Notes bidirectional + 10 max</li>
                    </ul>
                </div>

                <div class="bg-white border-2 border-warm-200 rounded-lg p-6">
                    <p class="font-medium text-ink mb-2">Empty State</p>
                    <p class="text-xs text-warm-500 mb-4">Skip-forward design</p>
                    <ul class="space-y-2 text-sm text-warm-600">
                        <li>Shield icon (positive framing)</li>
                        <li>"No exclusions needed?"</li>
                        <li>Primary: Continue Without Exclusions</li>
                        <li>Secondary: "or Add an exclusion"</li>
                    </ul>
                </div>

                <div class="bg-white border-2 border-warm-200 rounded-lg p-6">
                    <p class="font-medium text-ink mb-2">Add Exclusion Modal</p>
                    <p class="text-xs text-warm-500 mb-4">Search and select flow</p>
                    <ul class="space-y-2 text-sm text-warm-600">
                        <li>Search input with icon</li>
                        <li>Merchant result cards</li>
                        <li>Optional reason textarea</li>
                        <li>Add Exclusion button</li>
                    </ul>
                </div>

                <div class="bg-white border-2 border-warm-200 rounded-lg p-6">
                    <p class="font-medium text-ink mb-2">Exclusion Card</p>
                    <p class="text-xs text-warm-500 mb-4">Display excluded merchant</p>
                    <ul class="space-y-2 text-sm text-warm-600">
                        <li>Logo/initials + name + domain</li>
                        <li>Optional reason (italic)</li>
                        <li>Remove button (red text)</li>
                        <li>Counter: X of 10 used</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Related -->
        <section class="mb-16">
            <p class="serial text-intaglio-500 mb-4">3. Related</p>

            <div class="grid grid-cols-3 gap-4">
                <a href="/merchant/screens/onboarding-phase-7-payout-schedule.html" class="block bg-white border-2 border-warm-200 rounded-lg p-4 hover:border-warm-300 transition-colors">
                    <p class="font-medium text-ink mb-1">Phase 7: Payout Schedule</p>
                    <p class="text-xs text-warm-500">Previous onboarding step.</p>
                </a>
                <a href="/merchant/screens/onboarding-phase-9-launch-cohort.html" class="block bg-white border-2 border-warm-200 rounded-lg p-4 hover:border-warm-300 transition-colors">
                    <p class="font-medium text-ink mb-1">Phase 9: Launch Cohort</p>
                    <p class="text-xs text-warm-500">Final onboarding step.</p>
                </a>
                <a href="/merchant/screens/settings.html" class="block bg-white border-2 border-warm-200 rounded-lg p-4 hover:border-warm-300 transition-colors">
                    <p class="font-medium text-ink mb-1">Settings Screen</p>
                    <p class="text-xs text-warm-500">Post-onboarding management.</p>
                </a>
            </div>
        </section>

    </div>

    <!-- Footer -->
    <footer class="bg-white border-t-2 border-warm-200 px-8 py-8 mt-12">
        <div class="max-w-6xl mx-auto flex items-center justify-between">
            <div class="flex items-center gap-3">
                <img src="/assets/logos/svg/saltwyk-logomark-emerald.svg" alt="Saltwyk" class="h-6 w-auto opacity-50">
                <span class="text-sm text-warm-500">Saltwyk Design System v0.5</span>
            </div>
            <div class="flex items-center gap-6 text-sm text-warm-500">
                <a href="/sitemap.html" class="hover:text-emerald-600">Sitemap</a>
                <a href="/core/tokens/" class="hover:text-emerald-600">Foundation</a>
            </div>
        </div>
    </footer>
        </main>
    </div>

    <!-- Add Exclusion Modal -->
    <div class="modal-overlay" id="exclusion-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add Exclusion</h3>
                <button class="modal-close" id="modal-close" aria-label="Close">
                    <i data-lucide="x"></i>
                </button>
            </div>
            <div class="modal-body">
                <!-- Search Input -->
                <div class="search-input">
                    <i data-lucide="search" class="w-5 h-5"></i>
                    <input
                        type="search"
                        id="merchant-search"
                        placeholder="Search by name or domain..."
                        aria-label="Search for merchant"
                    >
                </div>

                <!-- Search Results -->
                <div class="search-results" id="search-results">
                    <p class="search-results-empty" id="search-empty">
                        Start typing to search merchants on the network
                    </p>

                    <!-- Results (populated by JS) -->
                    <div id="search-results-list" style="display: none;"></div>
                </div>

                <!-- Selected Merchant & Reason (shown after selection) -->
                <div id="reason-section" style="display: none;">
                    <div class="selected-merchant" id="selected-merchant">
                        <div class="selected-merchant-logo" id="selected-logo">C</div>
                        <div class="selected-merchant-info">
                            <h4 id="selected-name">Competitor Store</h4>
                            <p id="selected-domain">competitor-store.com</p>
                        </div>
                        <i data-lucide="check-circle" class="w-5 h-5"></i>
                    </div>

                    <div class="reason-form">
                        <label for="exclusion-reason">Why are you excluding this merchant? (Optional)</label>
                        <textarea
                            id="exclusion-reason"
                            rows="3"
                            placeholder="e.g., Direct competitor, past business dispute, etc."
                            maxlength="500"
                        ></textarea>
                        <p class="form-hint">This helps us understand exclusion patterns. Your reason is private.</p>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" id="cancel-btn">Cancel</button>
                <button class="btn-primary" id="confirm-btn" disabled>
                    <i data-lucide="plus" class="w-4 h-4"></i>
                    Add Exclusion
                </button>
            </div>
        </div>
    </div>

    <script>lucide.createIcons();</script>
    <script src="/partials/nav-loader.js"></script>

    <script>
        (function() {
            // State - starts empty for interactive demo
            let exclusions = [];
            let selectedMerchant = null;
            const MAX_EXCLUSIONS = 10;

            // Demo merchants for search
            const demoMerchants = [
                { id: 'merch_001', name: 'Competitor Store', domain: 'competitor-store.com', initials: 'CS' },
                { id: 'merch_002', name: 'Problem Merchant', domain: 'problem-merchant.com', initials: 'PM' },
                { id: 'merch_003', name: 'Rival Boutique', domain: 'rivalboutique.com', initials: 'RB' },
                { id: 'merch_004', name: 'Market Competitor', domain: 'marketcomp.com', initials: 'MC' },
                { id: 'merch_005', name: 'Similar Shop', domain: 'similarshop.com', initials: 'SS' },
                { id: 'merch_006', name: 'Direct Rival', domain: 'directrival.com', initials: 'DR' },
                { id: 'merch_007', name: 'Category Leader', domain: 'categoryleader.com', initials: 'CL' },
                { id: 'merch_008', name: 'Niche Competitor', domain: 'nichecomp.com', initials: 'NC' }
            ];

            // Elements
            const emptyState = document.getElementById('empty-state');
            const exclusionsList = document.getElementById('exclusions-list');
            const exclusionCards = document.getElementById('exclusion-cards');
            const exclusionsCount = document.getElementById('exclusions-count');
            const addFirstBtn = document.getElementById('add-first-btn');
            const addAnotherBtn = document.getElementById('add-another-btn');
            const addAnotherText = document.getElementById('add-another-text');
            const skipBtn = document.getElementById('skip-btn');
            const continueBtn = document.getElementById('continue-btn');
            const successBanner = document.getElementById('success-banner');

            // Modal elements
            const modal = document.getElementById('exclusion-modal');
            const modalClose = document.getElementById('modal-close');
            const searchInput = document.getElementById('merchant-search');
            const searchEmpty = document.getElementById('search-empty');
            const searchResultsList = document.getElementById('search-results-list');
            const reasonSection = document.getElementById('reason-section');
            const selectedLogo = document.getElementById('selected-logo');
            const selectedName = document.getElementById('selected-name');
            const selectedDomain = document.getElementById('selected-domain');
            const exclusionReason = document.getElementById('exclusion-reason');
            const cancelBtn = document.getElementById('cancel-btn');
            const confirmBtn = document.getElementById('confirm-btn');

            // Update UI based on exclusions
            function updateUI() {
                const hasExclusions = exclusions.length > 0;
                const atLimit = exclusions.length >= MAX_EXCLUSIONS;

                emptyState.style.display = hasExclusions ? 'none' : 'block';
                exclusionsList.style.display = hasExclusions ? 'block' : 'none';

                exclusionsCount.textContent = `${exclusions.length} of ${MAX_EXCLUSIONS} used`;
                exclusionsCount.classList.toggle('exclusions-count--limit', atLimit);

                const remaining = MAX_EXCLUSIONS - exclusions.length;
                addAnotherText.textContent = atLimit
                    ? 'Maximum exclusions reached'
                    : `Add Another Exclusion (${remaining} remaining)`;
                addAnotherBtn.disabled = atLimit;

                // Render cards
                exclusionCards.innerHTML = exclusions.map((exc, index) => `
                    <div class="exclusion-card">
                        <div class="exclusion-card-header">
                            <div class="exclusion-card-logo">${exc.initials}</div>
                            <div class="exclusion-card-info">
                                <h4 class="exclusion-card-name">${exc.name}</h4>
                                <p class="exclusion-card-domain">${exc.domain}</p>
                            </div>
                        </div>
                        ${exc.reason ? `
                            <div class="exclusion-card-reason">
                                <p>"${exc.reason}"</p>
                            </div>
                        ` : ''}
                        <div class="exclusion-card-actions">
                            <button class="btn-text btn-danger" data-index="${index}">
                                Remove
                            </button>
                        </div>
                    </div>
                `).join('');

                // Add remove handlers
                document.querySelectorAll('.exclusion-card .btn-danger').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const index = parseInt(this.dataset.index);
                        if (confirm(`Remove exclusion for ${exclusions[index].name}?`)) {
                            exclusions.splice(index, 1);
                            updateUI();
                        }
                    });
                });
            }

            // Open modal
            function openModal() {
                modal.classList.add('active');
                resetModal();
                searchInput.focus();
            }

            // Close modal
            function closeModal() {
                modal.classList.remove('active');
                resetModal();
            }

            // Reset modal state
            function resetModal() {
                searchInput.value = '';
                searchEmpty.style.display = 'block';
                searchResultsList.style.display = 'none';
                searchResultsList.innerHTML = '';
                reasonSection.style.display = 'none';
                exclusionReason.value = '';
                selectedMerchant = null;
                confirmBtn.disabled = true;
            }

            // Search merchants
            function searchMerchants(query) {
                if (query.length < 2) {
                    searchEmpty.textContent = 'Start typing to search merchants on the network';
                    searchEmpty.style.display = 'block';
                    searchResultsList.style.display = 'none';
                    return;
                }

                const excludedIds = exclusions.map(e => e.id);
                const results = demoMerchants.filter(m =>
                    !excludedIds.includes(m.id) &&
                    (m.name.toLowerCase().includes(query.toLowerCase()) ||
                     m.domain.toLowerCase().includes(query.toLowerCase()))
                );

                if (results.length === 0) {
                    searchEmpty.textContent = `No merchants found matching "${query}"`;
                    searchEmpty.style.display = 'block';
                    searchResultsList.style.display = 'none';
                    return;
                }

                searchEmpty.style.display = 'none';
                searchResultsList.style.display = 'block';
                searchResultsList.innerHTML = results.map(m => `
                    <button class="merchant-result-item" data-merchant='${JSON.stringify(m)}'>
                        <div class="merchant-result-logo">${m.initials}</div>
                        <div class="merchant-result-info">
                            <h4>${m.name}</h4>
                            <p>${m.domain}</p>
                        </div>
                        <i data-lucide="plus" class="w-5 h-5"></i>
                    </button>
                `).join('');

                lucide.createIcons();

                // Add click handlers
                searchResultsList.querySelectorAll('.merchant-result-item').forEach(item => {
                    item.addEventListener('click', function() {
                        selectMerchant(JSON.parse(this.dataset.merchant));
                    });
                });
            }

            // Select merchant
            function selectMerchant(merchant) {
                selectedMerchant = merchant;
                selectedLogo.textContent = merchant.initials;
                selectedName.textContent = merchant.name;
                selectedDomain.textContent = merchant.domain;

                searchEmpty.style.display = 'none';
                searchResultsList.style.display = 'none';
                reasonSection.style.display = 'block';
                confirmBtn.disabled = false;

                lucide.createIcons();
            }

            // Add exclusion
            function addExclusion() {
                if (!selectedMerchant) return;

                exclusions.push({
                    ...selectedMerchant,
                    reason: exclusionReason.value.trim() || null
                });

                closeModal();
                updateUI();
            }

            // Event listeners
            addFirstBtn.addEventListener('click', openModal);
            addAnotherBtn.addEventListener('click', openModal);
            modalClose.addEventListener('click', closeModal);
            cancelBtn.addEventListener('click', closeModal);
            confirmBtn.addEventListener('click', addExclusion);

            modal.addEventListener('click', function(e) {
                if (e.target === this) closeModal();
            });

            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape' && modal.classList.contains('active')) {
                    closeModal();
                }
            });

            // Debounced search
            let searchTimeout;
            searchInput.addEventListener('input', function() {
                clearTimeout(searchTimeout);
                searchTimeout = setTimeout(() => {
                    searchMerchants(this.value);
                }, 300);
            });

            // Skip button
            skipBtn.addEventListener('click', function() {
                console.log('Skipping exclusions, navigating to Phase 9');
                // window.location.href = '/merchant/screens/onboarding-phase-9-launch-cohort.html';
            });

            // Continue button
            continueBtn.addEventListener('click', function() {
                this.disabled = true;
                this.innerHTML = '<span>Saving...</span>';

                setTimeout(() => {
                    console.log('Exclusions saved:', exclusions);
                    successBanner.classList.add('visible');
                    this.innerHTML = '<i data-lucide="check" class="w-4 h-4"></i> Saved';
                    lucide.createIcons();

                    // In production: navigate to Phase 9
                    // window.location.href = '/merchant/screens/onboarding-phase-9-launch-cohort.html';
                }, 1000);
            });

            // Initialize
            updateUI();
        })();
    </script>
</body>
</html>
