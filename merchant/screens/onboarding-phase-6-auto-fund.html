<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Onboarding Phase 6: Auto-Fund Settings | Merchant Screens | Saltwyk Design System</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fraunces:ital,opsz,wght@0,9..144,100..900;1,9..144,100..900&family=Inter:wght@400;500;600;700&family=Outfit:wght@600&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="/assets/config/tailwind.config.js"></script>
    <link rel="stylesheet" href="/assets/config/design-tokens.css">
    <link rel="stylesheet" href="/assets/config/view-toggle.css">

    <style>
        .font-display { font-family: 'Fraunces', Georgia, serif; }
        .font-brand { font-family: 'Outfit', system-ui, sans-serif; }
        .serial { font-weight: 600; font-size: 11px; letter-spacing: 0.12em; text-transform: uppercase; }
        code { font-size: 11px; background: hsl(var(--warm-100)); padding: 2px 6px; border-radius: 4px; font-family: ui-monospace, monospace; }

        .thread-cool {
            background: linear-gradient(90deg, hsl(var(--cyan-thread)), hsl(var(--magenta-thread)));
        }

        /* Setup Progress */
        .progress-steps { display: flex; align-items: center; gap: 8px; }
        .step-dot { width: 10px; height: 10px; border-radius: 50%; background: hsl(var(--warm-300)); flex-shrink: 0; }
        .step-dot.completed { background: hsl(var(--emerald-500)); }
        .step-dot.active { background: hsl(var(--indigo-500)); box-shadow: 0 0 0 4px hsl(var(--indigo-100)); }
        .step-line { flex: 1; height: 2px; background: hsl(var(--warm-200)); }
        .step-line.completed { background: hsl(var(--emerald-500)); }

        .mobile-step-card { background: white; border: 1px solid hsl(var(--warm-200)); border-radius: 12px; padding: 20px; }
        .mobile-step-card .step-counter { font-size: 12px; color: hsl(var(--warm-500)); margin-bottom: 4px; }
        .mobile-step-card h3 { font-size: 18px; font-weight: 600; color: hsl(var(--ink)); margin-bottom: 4px; }
        .mobile-step-card p { font-size: 14px; color: hsl(var(--warm-500)); }

        /* Onboarding Layout */
        .onboarding-screen { max-width: 680px; margin: 0 auto; padding: 40px 24px; }
        .onboarding-header { margin-bottom: 32px; }
        .onboarding-back { display: inline-flex; align-items: center; gap: 8px; font-size: 14px; color: hsl(var(--warm-500)); text-decoration: none; margin-bottom: 16px; }
        .onboarding-back:hover { color: hsl(var(--warm-700)); }
        .onboarding-title { font-family: 'Fraunces', Georgia, serif; font-size: 28px; font-weight: 700; color: hsl(var(--ink)); margin-bottom: 8px; }
        .onboarding-subtitle { font-size: 16px; color: hsl(var(--warm-600)); line-height: 1.5; }

        /* Info Box */
        .info-box { background: hsl(var(--indigo-50)); border: 1px solid hsl(var(--indigo-200)); border-radius: 8px; padding: 20px; margin-bottom: 32px; }
        .info-box h4 { font-size: 14px; font-weight: 600; color: hsl(var(--indigo-700)); margin-bottom: 12px; display: flex; align-items: center; gap: 8px; }
        .info-box ul { list-style: none; padding: 0; margin: 0; }
        .info-box li { font-size: 14px; color: hsl(var(--indigo-600)); padding: 4px 0; padding-left: 20px; position: relative; }
        .info-box li::before { content: "â€¢"; position: absolute; left: 0; color: hsl(var(--indigo-400)); }

        /* Radio Cards */
        .radio-cards { margin-bottom: 24px; }
        .radio-card { display: block; background: white; border: 2px solid hsl(var(--warm-200)); border-radius: 10px; padding: 20px; margin-bottom: 16px; cursor: pointer; transition: all 0.15s ease; position: relative; }
        .radio-card:hover { border-color: hsl(var(--warm-300)); background: hsl(var(--warm-50)); }
        .radio-card.selected { border-color: hsl(var(--indigo-500)); background: hsl(var(--indigo-50)); }
        .radio-card input[type="radio"] { position: absolute; opacity: 0; pointer-events: none; }

        .radio-card-header { display: flex; align-items: center; gap: 16px; margin-bottom: 8px; }
        .radio-indicator { width: 20px; height: 20px; border: 2px solid hsl(var(--warm-400)); border-radius: 50%; flex-shrink: 0; display: flex; align-items: center; justify-content: center; transition: all 0.15s ease; }
        .radio-card.selected .radio-indicator { border-color: hsl(var(--indigo-500)); background: hsl(var(--indigo-500)); }
        .radio-indicator::after { content: ""; width: 8px; height: 8px; background: white; border-radius: 50%; opacity: 0; transition: opacity 0.15s ease; }
        .radio-card.selected .radio-indicator::after { opacity: 1; }

        .radio-card-title { font-size: 16px; font-weight: 600; color: hsl(var(--ink)); flex: 1; }
        .badge-recommended { display: inline-flex; padding: 4px 12px; background: hsl(var(--emerald-500)); color: white; border-radius: 12px; font-size: 12px; font-weight: 600; }

        .radio-card-description { font-size: 14px; color: hsl(var(--warm-600)); line-height: 1.5; padding-left: 36px; }

        /* Auto-fund Configuration */
        .auto-fund-config { padding-left: 36px; margin-top: 20px; padding-top: 20px; border-top: 1px solid hsl(var(--indigo-200)); display: none; }
        .radio-card.selected .auto-fund-config { display: block; }

        .config-row { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px; }

        .form-field { margin-bottom: 16px; }
        .form-field:last-child { margin-bottom: 0; }
        .form-label { display: block; font-size: 14px; font-weight: 500; color: hsl(var(--ink)); margin-bottom: 8px; }
        .form-hint { font-size: 12px; color: hsl(var(--warm-500)); margin-top: 6px; }

        .dollar-input { position: relative; display: flex; align-items: center; }
        .dollar-prefix { position: absolute; left: 14px; font-size: 16px; font-weight: 500; color: hsl(var(--warm-500)); pointer-events: none; z-index: 1; }
        .dollar-input input { width: 100%; padding: 12px 14px 12px 32px; font-size: 16px; font-weight: 500; color: hsl(var(--ink)); background: white; border: 1px solid hsl(var(--warm-300)); border-radius: 8px; transition: all 0.15s ease; }
        .dollar-input input:focus { outline: none; border-color: hsl(var(--indigo-500)); box-shadow: 0 0 0 3px hsl(var(--indigo-500) / 10%); }

        .payment-method-display { background: hsl(var(--warm-50)); border: 1px solid hsl(var(--warm-200)); border-radius: 8px; padding: 16px; margin-bottom: 16px; }
        .payment-method-display label { font-size: 12px; font-weight: 600; color: hsl(var(--warm-500)); text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 6px; display: block; }
        .payment-method-display .bank-name { font-size: 15px; font-weight: 500; color: hsl(var(--ink)); margin-bottom: 4px; }
        .payment-method-display .bank-details { font-size: 13px; color: hsl(var(--warm-500)); }

        .frequency-estimate { background: hsl(var(--emerald-50)); border: 1px solid hsl(var(--emerald-200)); border-radius: 8px; padding: 14px 16px; display: flex; align-items: center; gap: 10px; }
        .frequency-estimate-icon { width: 18px; height: 18px; color: hsl(var(--emerald-600)); flex-shrink: 0; }
        .frequency-estimate-text { font-size: 14px; color: hsl(var(--emerald-700)); }
        .frequency-estimate-text strong { font-weight: 600; }

        /* Warning */
        .config-warning { display: none; background: hsl(var(--orange-50)); border: 1px solid hsl(var(--orange-200)); border-radius: 8px; padding: 12px 16px; margin-bottom: 16px; }
        .config-warning.visible { display: flex; align-items: flex-start; gap: 10px; }
        .config-warning-icon { width: 16px; height: 16px; color: hsl(var(--orange-500)); flex-shrink: 0; margin-top: 2px; }
        .config-warning-text { font-size: 13px; color: hsl(var(--orange-700)); line-height: 1.4; }

        /* Form Actions */
        .form-actions { display: flex; justify-content: space-between; align-items: center; margin-top: 32px; padding-top: 24px; border-top: 1px solid hsl(var(--warm-200)); }

        .btn-back { display: inline-flex; align-items: center; gap: 8px; padding: 12px 20px; background: white; color: hsl(var(--warm-600)); border: 1px solid hsl(var(--warm-300)); border-radius: 8px; font-size: 14px; font-weight: 500; cursor: pointer; transition: all 0.15s ease; }
        .btn-back:hover { background: hsl(var(--warm-50)); border-color: hsl(var(--warm-400)); color: hsl(var(--warm-700)); }

        .btn-continue { display: inline-flex; align-items: center; gap: 8px; padding: 12px 24px; background: hsl(var(--emerald-600)); color: white; border: none; border-radius: 8px; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.15s ease; }
        .btn-continue:hover { background: hsl(var(--emerald-700)); }

        /* Success Message */
        .success-banner { display: none; background: hsl(var(--emerald-50)); border: 1px solid hsl(var(--emerald-200)); border-radius: 8px; padding: 16px 20px; margin-bottom: 24px; }
        .success-banner.visible { display: flex; align-items: center; gap: 12px; }
        .success-banner-icon { color: hsl(var(--emerald-500)); flex-shrink: 0; }
        .success-banner-text { font-size: 14px; color: hsl(var(--emerald-700)); }

        /* Responsive */
        @media (max-width: 639px) {
            .onboarding-screen { padding: 24px 16px; }
            .onboarding-title { font-size: 24px; }
            .config-row { grid-template-columns: 1fr; gap: 16px; }
            .form-actions { flex-direction: column; gap: 12px; }
            .form-actions button { width: 100%; justify-content: center; }
            .auto-fund-config { padding-left: 0; }
            .radio-card-description { padding-left: 0; margin-top: 8px; }
        }
    </style>
</head>
<body class="bg-ledger text-ink">
    <div id="top-nav"></div>

    <div class="flex">
        <div id="side-nav"></div>
        <main class="flex-1">
            <div class="h-[3px] w-full thread-cool"></div>

    <div class="max-w-6xl mx-auto p-8">
        <nav class="flex items-center gap-2 text-sm text-warm-500 mb-8">
            <a href="/" class="hover:text-emerald-600">Design System</a>
            <span>&rarr;</span>
            <a href="/merchant/" class="hover:text-emerald-600">Merchant</a>
            <span>&rarr;</span>
            <a href="/merchant/screens/" class="hover:text-emerald-600">Screens</a>
            <span>&rarr;</span>
            <span class="text-ink font-medium">Onboarding Phase 6</span>
        </nav>

        <header class="mb-12">
            <p class="serial text-intaglio-500 mb-2">Screen Specification</p>
            <h1 class="font-display text-4xl mb-2">Phase 6: Auto-Fund Settings</h1>
            <p class="text-warm-600">Step 6 of 9 in merchant onboarding. Configure automatic clearing balance replenishment.</p>
        </header>

        <!-- Full Screen Preview -->
        <section class="mb-16">
            <p class="serial text-intaglio-500 mb-4">1. Full Screen Preview</p>
            <p class="text-sm text-warm-600 mb-6">Auto-fund configuration with recommended defaults. Both options (auto-fund and manual) are valid choices.</p>

            <div class="bg-warm-100 border-2 border-warm-200 rounded-lg p-6">
                <div class="bg-ledger rounded-lg shadow-lg overflow-hidden">
                    <div class="h-[3px] w-full thread-cool"></div>

                    <div class="onboarding-screen">
                        <!-- Back Link -->
                        <a href="/merchant/screens/onboarding-phase-5-fund-clearing-balance.html" class="onboarding-back">
                            <i data-lucide="arrow-left" class="w-4 h-4"></i>
                            Back
                        </a>

                        <!-- Setup Progress - Step 6 of 9 -->
                        <div class="mb-8">
                            <div class="progress-steps mb-4">
                                <div class="step-dot completed"></div>
                                <div class="step-line completed"></div>
                                <div class="step-dot completed"></div>
                                <div class="step-line completed"></div>
                                <div class="step-dot completed"></div>
                                <div class="step-line completed"></div>
                                <div class="step-dot completed"></div>
                                <div class="step-line completed"></div>
                                <div class="step-dot completed"></div>
                                <div class="step-line completed"></div>
                                <div class="step-dot active"></div>
                                <div class="step-line"></div>
                                <div class="step-dot"></div>
                                <div class="step-line"></div>
                                <div class="step-dot"></div>
                                <div class="step-line"></div>
                                <div class="step-dot"></div>
                            </div>
                            <div class="mobile-step-card">
                                <p class="step-counter">Step 6 of 9</p>
                                <h3>Auto-Fund Settings</h3>
                                <p>Configure automatic balance replenishment to avoid running out.</p>
                            </div>
                        </div>

                        <!-- Page Header -->
                        <div class="onboarding-header">
                            <h1 class="onboarding-title">Auto-Fund Settings</h1>
                            <p class="onboarding-subtitle">Automatically replenish your clearing balance to avoid running out.</p>
                        </div>

                        <!-- Success Banner (hidden by default) -->
                        <div class="success-banner" id="success-banner">
                            <i data-lucide="check-circle" class="success-banner-icon w-5 h-5"></i>
                            <span class="success-banner-text" id="success-text">Auto-fund settings saved!</span>
                        </div>

                        <!-- Info Box -->
                        <div class="info-box">
                            <h4><i data-lucide="zap" class="w-4 h-4"></i> Why auto-fund?</h4>
                            <ul>
                                <li>Never run out of clearing balance</li>
                                <li>Hands-free balance management</li>
                                <li>Free ACH transfers (1-2 business days)</li>
                            </ul>
                        </div>

                        <!-- Radio Cards -->
                        <div class="radio-cards">
                            <!-- Option 1: Auto-fund enabled (Recommended) -->
                            <label class="radio-card selected" id="auto-fund-card" onclick="selectAutoFund()">
                                <input type="radio" name="auto-fund-choice" value="enabled" checked>
                                <div class="radio-card-header">
                                    <span class="radio-indicator"></span>
                                    <span class="radio-card-title">Turn on auto-fund</span>
                                    <span class="badge-recommended">Recommended</span>
                                </div>

                                <!-- Configuration (shown when selected) -->
                                <div class="auto-fund-config">
                                    <div class="config-row">
                                        <div class="form-field">
                                            <label for="threshold" class="form-label">Trigger when balance drops below:</label>
                                            <div class="dollar-input">
                                                <span class="dollar-prefix">$</span>
                                                <input type="number" id="threshold" value="2000" min="500" max="10000" step="100">
                                            </div>
                                            <p class="form-hint">We'll initiate transfer at this amount</p>
                                        </div>

                                        <div class="form-field">
                                            <label for="replenish-amount" class="form-label">Automatically add:</label>
                                            <div class="dollar-input">
                                                <span class="dollar-prefix">$</span>
                                                <input type="number" id="replenish-amount" value="3000" min="500" max="50000" step="100">
                                            </div>
                                            <p class="form-hint">Amount added each time</p>
                                        </div>
                                    </div>

                                    <!-- Warning (shown conditionally) -->
                                    <div class="config-warning" id="config-warning">
                                        <i data-lucide="alert-triangle" class="config-warning-icon"></i>
                                        <p class="config-warning-text" id="warning-text">Replenish amount should be greater than threshold to avoid frequent triggers.</p>
                                    </div>

                                    <div class="payment-method-display">
                                        <label>Payment method</label>
                                        <p class="bank-name">ACH from Bank of America (...4567)</p>
                                        <p class="bank-details">Free &bull; 1-2 business days</p>
                                    </div>

                                    <div class="frequency-estimate">
                                        <i data-lucide="repeat" class="frequency-estimate-icon"></i>
                                        <p class="frequency-estimate-text">Estimated frequency: <strong id="frequency-text">~1x per week</strong> based on expected volume</p>
                                    </div>
                                </div>
                            </label>

                            <!-- Option 2: Manual management -->
                            <label class="radio-card" id="manual-card" onclick="selectManual()">
                                <input type="radio" name="auto-fund-choice" value="manual">
                                <div class="radio-card-header">
                                    <span class="radio-indicator"></span>
                                    <span class="radio-card-title">I'll manage my balance manually</span>
                                </div>
                                <p class="radio-card-description">
                                    You'll need to add funds manually when your balance is low. We'll send you email notifications when it's time to add more.
                                </p>
                            </label>
                        </div>

                        <!-- Form Actions -->
                        <div class="form-actions">
                            <button type="button" class="btn-back" onclick="window.history.back()">
                                <i data-lucide="arrow-left" class="w-4 h-4"></i>
                                Back
                            </button>
                            <button type="button" class="btn-continue" id="continue-btn">
                                Continue
                                <i data-lucide="arrow-right" class="w-4 h-4"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Component Breakdown -->
        <section class="mb-16">
            <p class="serial text-intaglio-500 mb-4">2. Component Breakdown</p>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <div class="bg-white border-2 border-warm-200 rounded-lg p-6">
                    <p class="font-medium text-ink mb-2">Radio Card Selection</p>
                    <p class="text-xs text-warm-500 mb-4">Settings-style pattern</p>
                    <ul class="space-y-2 text-sm text-warm-600">
                        <li>Visual radio indicator (custom styled)</li>
                        <li>Selected state: indigo border/background</li>
                        <li>Configuration reveals on selection</li>
                        <li>"Recommended" badge for auto-fund</li>
                    </ul>
                </div>

                <div class="bg-white border-2 border-warm-200 rounded-lg p-6">
                    <p class="font-medium text-ink mb-2">Dollar Input Fields</p>
                    <p class="text-xs text-warm-500 mb-4">Currency input pattern</p>
                    <ul class="space-y-2 text-sm text-warm-600">
                        <li>$ prefix positioned inside input</li>
                        <li>Number input with min/max validation</li>
                        <li>Threshold: $500 - $10,000</li>
                        <li>Replenish: $500 - $50,000</li>
                    </ul>
                </div>

                <div class="bg-white border-2 border-warm-200 rounded-lg p-6">
                    <p class="font-medium text-ink mb-2">Frequency Estimation</p>
                    <p class="text-xs text-warm-500 mb-4">Dynamic calculation</p>
                    <ul class="space-y-2 text-sm text-warm-600">
                        <li>Updates as values change</li>
                        <li>Based on daily usage estimate</li>
                        <li>Shows: "~1x per week" etc.</li>
                        <li>Emerald styling for positive info</li>
                    </ul>
                </div>

                <div class="bg-white border-2 border-warm-200 rounded-lg p-6">
                    <p class="font-medium text-ink mb-2">Validation Warnings</p>
                    <p class="text-xs text-warm-500 mb-4">Soft warnings (non-blocking)</p>
                    <ul class="space-y-2 text-sm text-warm-600">
                        <li>Threshold near initial balance</li>
                        <li>Replenish less than threshold</li>
                        <li>Orange warning styling</li>
                        <li>Still allows submission</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- States -->
        <section class="mb-16">
            <p class="serial text-intaglio-500 mb-4">3. States</p>

            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <div class="bg-white border-2 border-warm-200 rounded-lg p-6">
                    <p class="font-medium text-ink mb-2">Auto-Fund Selected</p>
                    <p class="text-xs text-warm-500 mb-4">Default state</p>
                    <ul class="space-y-2 text-sm text-warm-600">
                        <li>Card has indigo border/bg</li>
                        <li>Configuration fields visible</li>
                        <li>Frequency estimate shown</li>
                        <li>Continue always enabled</li>
                    </ul>
                </div>

                <div class="bg-white border-2 border-warm-200 rounded-lg p-6">
                    <p class="font-medium text-ink mb-2">Manual Selected</p>
                    <p class="text-xs text-warm-500 mb-4">Alternative choice</p>
                    <ul class="space-y-2 text-sm text-warm-600">
                        <li>Manual card selected</li>
                        <li>Auto-fund config hidden</li>
                        <li>Description text shown</li>
                        <li>Continue still enabled</li>
                    </ul>
                </div>

                <div class="bg-white border-2 border-warm-200 rounded-lg p-6">
                    <p class="font-medium text-ink mb-2">Warning Shown</p>
                    <p class="text-xs text-warm-500 mb-4">Validation feedback</p>
                    <ul class="space-y-2 text-sm text-warm-600">
                        <li>Orange warning box appears</li>
                        <li>Non-blocking (soft warning)</li>
                        <li>User can still proceed</li>
                        <li>Helps optimize settings</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Related -->
        <section class="mb-16">
            <p class="serial text-intaglio-500 mb-4">4. Related</p>

            <div class="grid grid-cols-3 gap-4">
                <a href="/merchant/screens/onboarding-phase-5-fund-clearing-balance.html" class="block bg-white border-2 border-warm-200 rounded-lg p-4 hover:border-warm-300 transition-colors">
                    <p class="font-medium text-ink mb-1">Phase 5: Fund Balance</p>
                    <p class="text-xs text-warm-500">Previous onboarding step.</p>
                </a>
                <a href="/merchant/screens/settings.html" class="block bg-white border-2 border-warm-200 rounded-lg p-4 hover:border-warm-300 transition-colors">
                    <p class="font-medium text-ink mb-1">Settings</p>
                    <p class="text-xs text-warm-500">Where auto-fund can be changed later.</p>
                </a>
                <a href="/merchant/screens/clearing-balance.html" class="block bg-white border-2 border-warm-200 rounded-lg p-4 hover:border-warm-300 transition-colors">
                    <p class="font-medium text-ink mb-1">Clearing Balance</p>
                    <p class="text-xs text-warm-500">Dashboard view of balance.</p>
                </a>
            </div>
        </section>

    </div>

    <!-- Footer -->
    <footer class="bg-white border-t-2 border-warm-200 px-8 py-8 mt-12">
        <div class="max-w-6xl mx-auto flex items-center justify-between">
            <div class="flex items-center gap-3">
                <img src="/assets/logos/svg/saltwyk-logomark-emerald.svg" alt="Saltwyk" class="h-6 w-auto opacity-50">
                <span class="text-sm text-warm-500">Saltwyk Design System v0.5</span>
            </div>
            <div class="flex items-center gap-6 text-sm text-warm-500">
                <a href="/sitemap.html" class="hover:text-emerald-600">Sitemap</a>
                <a href="/core/tokens/" class="hover:text-emerald-600">Foundation</a>
            </div>
        </div>
    </footer>
        </main>
    </div>

    <script>lucide.createIcons();</script>
    <script src="/partials/nav-loader.js"></script>

    <script>
        (function() {
            const autoFundCard = document.getElementById('auto-fund-card');
            const manualCard = document.getElementById('manual-card');
            const thresholdInput = document.getElementById('threshold');
            const replenishInput = document.getElementById('replenish-amount');
            const frequencyText = document.getElementById('frequency-text');
            const configWarning = document.getElementById('config-warning');
            const warningText = document.getElementById('warning-text');
            const continueBtn = document.getElementById('continue-btn');
            const successBanner = document.getElementById('success-banner');
            const successText = document.getElementById('success-text');

            // Initial balance from Phase 5 (simulated)
            const initialBalance = 6500;
            const estimatedDailyUsage = 400; // Based on category

            window.selectAutoFund = function() {
                autoFundCard.classList.add('selected');
                manualCard.classList.remove('selected');
                autoFundCard.querySelector('input').checked = true;
            };

            window.selectManual = function() {
                manualCard.classList.add('selected');
                autoFundCard.classList.remove('selected');
                manualCard.querySelector('input').checked = true;
            };

            function estimateFrequency() {
                const threshold = parseInt(thresholdInput.value) || 2000;
                const replenish = parseInt(replenishInput.value) || 3000;

                // Days from initial balance to threshold
                const daysToThreshold = (initialBalance - threshold) / estimatedDailyUsage;

                let frequency;
                if (daysToThreshold < 3) frequency = "~2-3x per week";
                else if (daysToThreshold < 7) frequency = "~1x per week";
                else if (daysToThreshold < 14) frequency = "~2x per month";
                else frequency = "~1x per month";

                frequencyText.textContent = frequency;
            }

            function validateConfig() {
                const threshold = parseInt(thresholdInput.value) || 2000;
                const replenish = parseInt(replenishInput.value) || 3000;

                let showWarning = false;
                let message = '';

                if (replenish < threshold) {
                    showWarning = true;
                    message = 'Replenish amount should be greater than threshold to avoid frequent triggers.';
                } else if (threshold > initialBalance * 0.8) {
                    showWarning = true;
                    message = 'Threshold is very close to your current balance. Auto-fund may trigger immediately.';
                }

                configWarning.classList.toggle('visible', showWarning);
                if (showWarning) {
                    warningText.textContent = message;
                }
            }

            // Input event listeners
            thresholdInput.addEventListener('input', function() {
                estimateFrequency();
                validateConfig();
            });

            replenishInput.addEventListener('input', function() {
                estimateFrequency();
                validateConfig();
            });

            // Continue button
            continueBtn.addEventListener('click', function() {
                const isAutoFund = autoFundCard.classList.contains('selected');

                this.disabled = true;
                this.innerHTML = '<span>Saving...</span>';

                setTimeout(() => {
                    if (isAutoFund) {
                        successText.textContent = 'Auto-fund enabled! We\'ll automatically replenish your balance.';
                    } else {
                        successText.textContent = 'Settings saved. You\'ll manage your balance manually.';
                    }
                    successBanner.classList.add('visible');
                    this.innerHTML = '<i data-lucide="check" class="w-4 h-4"></i> Saved';
                    lucide.createIcons();

                    console.log('Auto-fund settings saved:', {
                        auto_fund_enabled: isAutoFund,
                        threshold: isAutoFund ? parseInt(thresholdInput.value) : null,
                        amount: isAutoFund ? parseInt(replenishInput.value) : null,
                        payment_method: isAutoFund ? 'ach' : null
                    });
                }, 1000);
            });

            // Initial calculations
            estimateFrequency();
            validateConfig();
        })();
    </script>
</body>
</html>
